<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>3D Tetris</title>
    <link href="tetris.css" rel="stylesheet"/>
</head>
<body>
<header>
    <div id="PLAYER_ACTIVE"></div>
    <button id="BUTTON_START">Start/Restart</button>
</header>
<main id="main" class="scene3d noSelection">
    <div class="coords" style="
            --coords-rotate-x:  85;
            --coords-rotate-y: -15;
            top:                60cqh;
    ">
        <div class="floor"><div class="toplight"></div></div>
        <div class="plane show xz-plane"></div>
        <div class="plane show yz-plane"></div>
<!--    tetrominos to be added here -->
    </div>
</main>
<footer>
    Use mouse or touch to rotate the coords.
    Arrow keys to move the tetromino.
    Shift + arrow keys to rotate.
</footer>

<script type="module">

    import {registerForMouseAndTouch}                 from "./scene3D/scene.js";
    import {projectNewTetronimo, registerKeyListener} from "./tetronimoProjector.js";
    import {RemoteObservableMapFactory}               from "./observableMap/remoteObservableMapFactory.js";
    import {TOPIC_REMOTE_OBSERVABLE}                  from "../server/S7-manyObs-SSE/remoteObservableConstants.js";
    import {startGame}                                from "./gameController.js";
    import {defaultConsoleLogging}                    from "../kolibri/logger/loggingSupport.js";

    defaultConsoleLogging("ch.fhnw", LOG_DEBUG);

    const main = document.getElementById("main");

    registerForMouseAndTouch(main); // the general handling of living in a 3D scene

    registerKeyListener();          // the game-specific key bindings

    const factory = RemoteObservableMapFactory(window.location.origin, TOPIC_REMOTE_OBSERVABLE);
    startGame(factory, projectNewTetronimo);

</script>
</body>
</html>
